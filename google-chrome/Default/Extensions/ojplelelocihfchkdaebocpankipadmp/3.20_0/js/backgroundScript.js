var connections={};chrome.runtime.onConnect.addListener(function(e){if("ScopusDDMExtension"==e.name){var s=e.sender.tab?e.sender.tab.id:void 0,n=function(n){if("response-to-cs"!==n.type)if("init-from-cs"!=n.type)"request-from-cs"===n.type&&(n.tabId=n.tabId||s,DDMMessageHandler.handleRequestMessage(n));else{connections[s]=e;var o=chrome.runtime.getManifest();e.postMessage({type:"init-response-to-cs",tabId:s,extensionVersion:o.version,extensionName:o.name})}};e.onMessage.addListener(n),e.onDisconnect.addListener(function(e){e.onMessage.removeListener(n),delete connections[s]})}});class DDMMessageHandler{static handleRequestMessage(e){if("undefined"==typeof PDFLocator)throw Error("PDFLocator library not found!");PDFLocator.locatePDF(e,function(s){DDMMessageHandler._processResponseMessage(e,s)})}static _processResponseMessage(e,s){var n=connections[e.tabId];if(!n)throw Error("Unable to find port for responding message to tab!");n.postMessage({type:"response-to-cs",data:s})}}